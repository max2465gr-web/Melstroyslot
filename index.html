<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Casino Royale</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@900&family=Roboto:wght@700&display=swap');

        :root {
            --bg-color-dark: #092c5e;
            --bg-color-light: #249cd0;
            --machine-gold: #e6b853;
            --machine-gold-dark: #b58928;
            --machine-inner: #0a0a0a;
            --neon-glow: #0ff;
        }

        * {
            box-sizing: border-box;
            user-select: none; /* –ó–∞–ø—Ä–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ */
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle at center, var(--bg-color-light) 0%, var(--bg-color-dark) 80%);
            font-family: 'Roboto', sans-serif;
            overflow: hidden;
        }

        /* –ù–µ–æ–Ω–æ–≤–∞—è –≤—ã–≤–µ—Å–∫–∞ */
        .casino-sign {
            font-family: 'Orbitron', sans-serif;
            font-size: 40px;
            color: #fff;
            text-shadow:
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 20px var(--neon-glow),
                0 0 40px var(--neon-glow),
                0 0 80px var(--neon-glow);
            margin-bottom: 20px;
            z-index: 10;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–∞—à–∏–Ω—ã */
        .slot-machine-container {
            position: relative;
            transform-origin: center center;
            /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∑—É–º —á–µ—Ä–µ–∑ JS –∏–ª–∏ Media Queries */
        }

        .slot-machine {
            width: 320px;
            height: 240px;
            background: linear-gradient(to bottom, var(--machine-gold), var(--machine-gold-dark));
            border-radius: 20px;
            padding: 15px;
            box-shadow:
                0 10px 30px rgba(0,0,0,0.5),
                inset 0 0 10px rgba(255,255,255,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        /* –û–∫–Ω–æ —Å –±–∞—Ä–∞–±–∞–Ω–∞–º–∏ */
        .reels-window {
            width: 100%;
            height: 100%;
            background: #000;
            border: 4px solid #5a3e08;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            justify-content: space-around;
            padding: 5px;
            position: relative;
        }

        /* –ë–ª–∏–∫–∏ –Ω–∞ —Å—Ç–µ–∫–ª–µ */
        .glass-reflection {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 40%, rgba(255,255,255,0.1) 100%);
            pointer-events: none;
            z-index: 5;
            border-radius: 8px;
        }

        /* –õ–∏–Ω–∏—è –≤—ã–∏–≥—Ä—ã—à–∞ */
        .win-line {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 2px;
            background: rgba(255, 0, 0, 0.3);
            z-index: 4;
            transform: translateY(-50%);
            box-shadow: 0 0 5px red;
        }

        /* –û—Ç–¥–µ–ª—å–Ω—ã–π –±–∞—Ä–∞–±–∞–Ω */
        .reel-col {
            width: 30%;
            height: 100%;
            background: #fff;
            border-radius: 4px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }

        /* –ü–æ–ª–æ—Å–∞ —Å–∏–º–≤–æ–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ –±–∞—Ä–∞–±–∞–Ω–∞ */
        .reel-strip {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            /* –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª */
            transform: translateY(0px);
            will-change: transform; /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª–æ–∫ */
        }

        .symbol {
            height: 80px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ —Å–∏–º–≤–æ–ª–∞ */
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 50px;
            line-height: 80px;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —Ä–∞–∑–º—ã—Ç–∏—è –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏ */
        .blur {
            filter: blur(4px);
        }

        /* –ú–µ—Ö–∞–Ω–∏–∑–º —Ä—ã—á–∞–≥–∞ (–±–∞–∑–∞) */
        .lever-base {
            position: absolute;
            right: -40px;
            top: 80px;
            width: 40px;
            height: 80px;
            background: #555;
            border-radius: 0 10px 10px 0;
            z-index: 1;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.5);
        }

        /* –ü–æ–¥–≤–∏–∂–Ω–∞—è —á–∞—Å—Ç—å —Ä—ã—á–∞–≥–∞ */
        .lever-arm {
            position: absolute;
            right: -30px;
            top: 100px; /* –¢–æ—á–∫–∞ –∫—Ä–µ–ø–ª–µ–Ω–∏—è */
            width: 20px;
            height: 100px; /* –î–ª–∏–Ω–∞ –ø–∞–ª–∫–∏ */
            transform-origin: top center;
            transform: rotate(0deg);
            z-index: 0;
            display: flex;
            justify-content: center;
        }

        .lever-stick {
            width: 12px;
            height: 100%;
            background: linear-gradient(90deg, #ccc, #666);
            border-radius: 6px;
        }

        .lever-ball {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: radial-gradient(circle at 30% 30%, #ff4d4d, #990000);
            border-radius: 50%;
            box-shadow: 0 5px 10px rgba(0,0,0,0.4);
            cursor: grab;
            touch-action: none; /* –í–∞–∂–Ω–æ –¥–ª—è –º–æ–±–∏–ª–æ–∫: –æ—Ç–∫–ª—é—á–∞–µ—Ç —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ */
        }

        .lever-ball:active {
            cursor: grabbing;
        }

        /* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–∞–ª–∞–Ω—Å–∞ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π */
        .ui-panel {
            margin-top: 30px;
            text-align: center;
            z-index: 10;
        }

        #balance {
            font-family: 'Orbitron', sans-serif;
            font-size: 24px;
            color: #ffd700;
            background: rgba(0,0,0,0.7);
            padding: 10px 20px;
            border-radius: 20px;
            border: 2px solid #ffd700;
            display: inline-block;
            margin-bottom: 10px;
        }

        #message {
            font-size: 18px;
            color: #fff;
            height: 24px;
            font-weight: bold;
            text-shadow: 0 1px 2px #000;
        }

        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–æ–Ω–µ—Ç—ã */
        .coins-bg {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 150px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='50' height='50' viewBox='0 0 50 50'%3E%3Ccircle cx='25' cy='25' r='20' fill='%23ffd700' opacity='0.5'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' font-size='20' fill='%23b58928'%3E$%3C/text%3E%3C/svg%3E");
            z-index: 0;
            opacity: 0.3;
            pointer-events: none;
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã */
        @media (max-width: 400px) {
            .slot-machine-container { transform: scale(0.85); }
        }
    </style>
</head>
<body>

    <div class="casino-sign">CASINO</div>

    <div class="slot-machine-container">
        <!-- –ö–æ—Ä–ø—É—Å -->
        <div class="slot-machine">
            <div class="reels-window">
                <div class="win-line"></div>
                <div class="glass-reflection"></div>

                <div class="reel-col"><div class="reel-strip" id="reel1"></div></div>
                <div class="reel-col"><div class="reel-strip" id="reel2"></div></div>
                <div class="reel-col"><div class="reel-strip" id="reel3"></div></div>
            </div>
        </div>

        <!-- –†—ã—á–∞–≥ -->
        <div class="lever-base"></div>
        <div class="lever-arm" id="leverArm">
            <div class="lever-stick"></div>
            <div class="lever-ball" id="leverBall"></div>
        </div>
    </div>

    <div class="ui-panel">
        <div id="balance">BALANCE: 1000</div>
        <div id="message">PULL THE LEVER TO SPIN!</div>
    </div>

    <div class="coins-bg"></div>

    <script>
        // === –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ===
        const SYMBOLS = ['üíé', '7Ô∏è‚É£', 'üîî', 'üçí', 'üçã', 'üçâ', 'üçá', '‚≠ê', 'üí∞', 'üçä'];
        // –í–µ—Å–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—á—Ç–æ–±—ã —Ä–µ–¥–∫–∏–µ –≤—ã–ø–∞–¥–∞–ª–∏ —Ä–µ–∂–µ, –µ—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ)
        const SYMBOL_HEIGHT = 80; // px
        const REEL_VISIBLE_ROWS = 3; // –Ω–æ —É –Ω–∞—Å –ø–æ —Ñ–∞–∫—Ç—É 1 —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è –≤–∞–∂–Ω–∞

        // –í—ã–ø–ª–∞—Ç—ã (–∑–∞ 3 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è)
        const PAYOUTS = {
            'üíé': 1000, 'üí∞': 500, '7Ô∏è‚É£': 300, '‚≠ê': 200,
            'üîî': 100, 'üçâ': 50, 'üçá': 40, 'üçä': 30, 'üçã': 20, 'üçí': 10
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ
        let balance = 1000;
        let isSpinning = false;
        const SPIN_COST = 50;

        // –≠–ª–µ–º–µ–Ω—Ç—ã
        const reels = [
            document.getElementById('reel1'),
            document.getElementById('reel2'),
            document.getElementById('reel3')
        ];
        const balanceEl = document.getElementById('balance');
        const messageEl = document.getElementById('message');

        // –†—ã—á–∞–≥
        const leverArm = document.getElementById('leverArm');
        const leverBall = document.getElementById('leverBall');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–∑–∞–ø–æ–ª–Ω—è–µ–º –±–∞—Ä–∞–±–∞–Ω—ã –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏)
        function initReels() {
            reels.forEach(reel => {
                let html = '';
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–ª–∏–Ω–Ω—É—é –ª–µ–Ω—Ç—É, —á—Ç–æ–±—ã –±—ã–ª–æ —á—Ç–æ –∫—Ä—É—Ç–∏—Ç—å
                // –ù–∞—á–Ω–µ–º —Å —Ä–∞–Ω–¥–æ–º–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
                for(let i=0; i<30; i++) {
                    const sym = SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];
                    html += `<div class="symbol">${sym}</div>`;
                }
                reel.innerHTML = html;
                // –°–¥–≤–∏–≥–∞–µ–º, —á—Ç–æ–±—ã —Ü–µ–Ω—Ç—Ä –±—ã–ª –≤–∏–∑—É–∞–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω (–ø—Ä–∏–º–µ—Ä–Ω–æ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –ª–µ–Ω—Ç—ã)
                // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, –Ω–∞—á–Ω–µ–º —Å Y=0, –∞ –∫—Ä—É—Ç–∏—Ç—å –±—É–¥–µ–º –≤ –º–∏–Ω—É—Å
                reel.style.transform = `translateY(-${10 * SYMBOL_HEIGHT + (SYMBOL_HEIGHT/2 - 40)}px)`;
            });

            // –ü–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å –∏–∑ URL
            const urlParams = new URLSearchParams(window.location.search);
            const startBal = parseInt(urlParams.get('balance'));
            if(!isNaN(startBal)) balance = startBal;
            updateUI();
        }

        function updateUI() {
            balanceEl.textContent = `BALANCE: ${balance}`;
        }

        // === –õ–û–ì–ò–ö–ê –†–´–ß–ê–ì–ê (DRAG) ===
        let isDragging = false;
        let startY = 0;
        let currentRotation = 0;
        const MAX_ROTATION = 150; // –≥—Ä–∞–¥—É—Å–æ–≤ –≤–Ω–∏–∑

        function startDrag(e) {
            if(isSpinning) return;
            isDragging = true;
            const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
            startY = clientY;
            leverBall.style.cursor = 'grabbing';
        }

        function onDrag(e) {
            if(!isDragging) return;
            e.preventDefault(); // —á—Ç–æ–±—ã –Ω–µ —Å–∫—Ä–æ–ª–ª–∏—Ç—å —ç–∫—Ä–∞–Ω

            const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
            let delta = clientY - startY;

            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –ø–∏–∫—Å–µ–ª–∏ –≤ –≥—Ä–∞–¥—É—Å—ã (–ø—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞)
            let rotation = delta * 0.8;

            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
            if(rotation < 0) rotation = 0;
            if(rotation > MAX_ROTATION) rotation = MAX_ROTATION;

            currentRotation = rotation;
            leverArm.style.transform = `rotate(${rotation}deg)`;
        }

        function endDrag() {
            if(!isDragging) return;
            isDragging = false;
            leverBall.style.cursor = 'grab';

            // –ï—Å–ª–∏ –ø–æ—Ç—è–Ω—É–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–ª—å–Ω–æ (>80%) - –∑–∞–ø—É—Å–∫–∞–µ–º —Å–ø–∏–Ω
            if(currentRotation > MAX_ROTATION * 0.8) {
                // –ê–Ω–∏–º–∞—Ü–∏—è "–æ—Ç—Å–∫–æ–∫–∞" —Ä—ã—á–∞–≥–∞ –≤–≤–µ—Ä—Ö
                animateLeverReturn(true);
            } else {
                // –ü—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞ –º–µ—Å—Ç–æ –±–µ–∑ —Å–ø–∏–Ω–∞
                animateLeverReturn(false);
            }
        }

        function animateLeverReturn(shouldSpin) {
            leverArm.style.transition = 'transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            leverArm.style.transform = 'rotate(0deg)';

            // –ñ–¥–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä—ã—á–∞–≥–∞
            setTimeout(() => {
                leverArm.style.transition = ''; // —É–±–∏—Ä–∞–µ–º transition –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥—Ä–∞–≥–∞
                if(shouldSpin) startSpin();
            }, 400);
        }

        // –°–æ–±—ã—Ç–∏—è –¥–ª—è –º—ã—à–∏ –∏ —Ç–∞—á–∞
        leverBall.addEventListener('mousedown', startDrag);
        document.addEventListener('mousemove', onDrag);
        document.addEventListener('mouseup', endDrag);

        leverBall.addEventListener('touchstart', startDrag, {passive: false});
        document.addEventListener('touchmove', onDrag, {passive: false});
        document.addEventListener('touchend', endDrag);


        // === –õ–û–ì–ò–ö–ê –ò–ì–†–´ ===
        function startSpin() {
            if (balance < SPIN_COST) {
                messageEl.textContent = "NOT ENOUGH MONEY!";
                messageEl.style.color = "red";
                return;
            }

            balance -= SPIN_COST;
            updateUI();
            messageEl.textContent = "GOOD LUCK!";
            messageEl.style.color = "#fff";
            isSpinning = true;

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const finalSymbols = [];
            for(let i=0; i<3; i++) {
                finalSymbols.push(SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)]);
            }

            // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Ä–∞—â–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –±–∞—Ä–∞–±–∞–Ω–∞
            reels.forEach((reel, index) => {
                // –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è (–∏–∑ transform)
                const currentY = parseFloat(reel.style.transform.replace('translateY(', '').replace('px)', '')) || 0;

                // –¶–µ–ª–µ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è:
                // –ú—ã —Ö–æ—Ç–∏–º –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç—å "–≤–Ω–∏–∑" (–∏–ª–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ –≤–≤–µ—Ä—Ö –ª–µ–Ω—Ç—É), –¥–æ–±–∞–≤–∏–≤ –º–Ω–æ–≥–æ –Ω–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
                // –ò –≤ –∫–æ–Ω—Ü–µ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –Ω–∞—à result

                // 1. –î–æ–±–∞–≤–ª—è–µ–º —Å–∏–º–≤–æ–ª—ã –≤ DOM
                const extraSymbols = 20 + index * 10; // —Ä–∞–∑–Ω–∞—è –¥–ª–∏–Ω–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –ª–µ—Å–µ–Ω–∫–∏
                let htmlToAdd = '';
                for(let k=0; k<extraSymbols; k++) {
                    htmlToAdd += `<div class="symbol blur">${SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)]}</div>`;
                }
                // –í –∫–æ–Ω—Ü–µ –¥–æ–±–∞–≤–ª—è–µ–º —Ü–µ–ª–µ–≤–æ–π —Å–∏–º–≤–æ–ª (–ë–ï–ó –±–ª—é—Ä–∞) –∏ –µ—â–µ –ø–∞—Ä—É –¥–ª—è —Ü–µ–Ω—Ç—Ä–æ–≤–∫–∏
                htmlToAdd += `<div class="symbol" id="res-sym-${index}">${finalSymbols[index]}</div>`;
                htmlToAdd += `<div class="symbol blur">${SYMBOLS[0]}</div>`; // –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–∞—Å–Ω–æ–π

                reel.innerHTML = htmlToAdd + reel.innerHTML; // –î–æ–±–∞–≤–ª—è–µ–º –°–í–ï–†–•–£ (–≤–∏–∑—É–∞–ª—å–Ω–æ —ç—Ç–æ –±—É–¥–µ—Ç –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏)

                // –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –¥–æ–±–∞–≤–∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–≤–µ—Ä—Ö—É, –ø–æ–∑–∏—Ü–∏—è —Å–±–∏–ª–∞—Å—å –±—ã. –ù–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–Ω–∏–º–∞—Ü–∏—é transition to.
                // –•–∏—Ç—Ä–æ—Å—Ç—å: –º—ã —Å–±—Ä–∞—Å—ã–≤–∞–µ–º transition, —Å—Ç–∞–≤–∏–º –ª–µ–Ω—Ç—É –≤—ã—Å–æ–∫–æ, –∞ –ø–æ—Ç–æ–º –ø–ª–∞–≤–Ω–æ –æ–ø—É—Å–∫–∞–µ–º –∫ —Ü–µ–ª–µ–≤–æ–º—É —Å–∏–º–≤–æ–ª—É.

                // –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è CSS –∞–Ω–∏–º–∞—Ü–∏–∏:
                // –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–µ–Ω—Ç—É
                reel.innerHTML = htmlToAdd;
                const totalH = (extraSymbols + 2) * SYMBOL_HEIGHT;

                // –°—Ç–∞–≤–∏–º –ª–µ–Ω—Ç—É —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–∏–∂–Ω–∏–π –∫—Ä–∞–π –±—ã–ª –≤–∏–¥–µ–Ω (—Å—Ç–∞—Ä–∞—è –ø–æ–∑–∏—Ü–∏—è) - –∏–º–∏—Ç–∞—Ü–∏—è
                reel.style.transition = 'none';
                reel.style.transform = `translateY(-${totalH - SYMBOL_HEIGHT * 3}px)`; // –°—Ç–∞—Ä—Ç —Å–Ω–∏–∑—É

                // –§–æ—Ä—Å–∏—Ä—É–µ–º reflow
                reel.offsetHeight;

                // –ê–Ω–∏–º–∏—Ä—É–µ–º –∫ –Ω—É–∂–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É
                // –¶–µ–ª–µ–≤–æ–π —Å–∏–º–≤–æ–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –∏–Ω–¥–µ–∫—Å–µ `extraSymbols`.
                // –ù–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –æ–Ω –≤—Å—Ç–∞–ª —Ä–æ–≤–Ω–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É –æ–∫–Ω–∞.
                // –û–∫–Ω–æ –≤—ã—Å–æ—Ç–æ–π ~200px (3 —Å–∏–º–≤–æ–ª–∞ –ø–æ 80px = 240px, –Ω–æ —É –Ω–∞—Å —Ä–∞–º–∫–∏).
                // –¶–µ–Ω—Ç—Ä –æ–∫–Ω–∞ = 110px. –¶–µ–Ω—Ç—Ä —Å–∏–º–≤–æ–ª–∞ = 40px.
                // –ù—É–∂–Ω–æ —Å–º–µ—â–µ–Ω–∏–µ —Ç–∞–∫, —á—Ç–æ–±—ã (index * 80) –æ–∫–∞–∑–∞–ª–æ—Å—å –≤ –Ω—É–∂–Ω–æ–π —Ç–æ—á–∫–µ.
                // –ü—Ä–æ—â–µ: –º—ã —Ö–æ—Ç–∏–º –ø–æ–∫–∞–∑–∞—Ç—å —Å–∏–º–≤–æ–ª –Ω–æ–º–µ—Ä `extraSymbols` (—ç—Ç–æ —Ü–µ–ª–µ–≤–æ–π).
                // –°–º–µ—â–µ–Ω–∏–µ = - (extraSymbols * 80) + –æ—Ç—Å—Ç—É–ø_–¥–ª—è_—Ü–µ–Ω—Ç—Ä–∞

                const targetY = -(extraSymbols * SYMBOL_HEIGHT) + (240/2 - SYMBOL_HEIGHT/2); // 240 - –≤—ã—Å–æ—Ç–∞ –æ–∫–Ω–∞

                const duration = 2 + index * 0.5;
                reel.style.transition = `transform ${duration}s cubic-bezier(0.25, 0.1, 0.25, 1)`;
                reel.style.transform = `translateY(${targetY}px)`;

                // –£–±–∏—Ä–∞–µ–º –±–ª—é—Ä –≤ –∫–æ–Ω—Ü–µ
                setTimeout(() => {
                    const targetEl = document.getElementById(`res-sym-${index}`);
                    if(targetEl) targetEl.classList.remove('blur');
                    // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –±–ª—é—Ä, –∏–ª–∏ —É–±—Ä–∞—Ç—å
                    document.querySelectorAll('.symbol').forEach(el => el.classList.remove('blur'));
                }, duration * 1000);
            });

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞ –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–∞—Ä–∞–±–∞–Ω–∞
            setTimeout(() => {
                checkWin(finalSymbols);
                isSpinning = false;
            }, 3500);
        }

        function checkWin(results) {
            const [s1, s2, s3] = results;
            let win = 0;

            if(s1 === s2 && s2 === s3) {
                // –î–∂–µ–∫–ø–æ—Ç 3 –≤ —Ä—è–¥
                win = PAYOUTS[s1] || 10;
                messageEl.textContent = `JACKPOT! +${win}`;
                messageEl.style.color = "#0f0";
                createCoinsExplosion();
            } else if (s1 === s2 || s2 === s3 || s1 === s3) {
                // 2 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω–æ: –ª—é–±—ã–µ 2 –¥–∞—é—Ç –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–∏–∑)
                // –ù–∞–π–¥–µ–º –∫–∞–∫–æ–π —Å–∏–º–≤–æ–ª —Å–æ–≤–ø–∞–ª
                let matchSym = (s1===s2) ? s1 : (s2===s3 ? s2 : s1);
                // –î–∞–¥–∏–º 20% –æ—Ç –ø–æ–ª–Ω–æ–π –Ω–∞–≥—Ä–∞–¥—ã
                win = Math.floor((PAYOUTS[matchSym] || 10) * 0.2);
                messageEl.textContent = `NICE! +${win}`;
                messageEl.style.color = "#ffd700";
            } else {
                messageEl.textContent = "TRY AGAIN";
            }

            if(win > 0) {
                balance += win;
                updateUI();
                // –¢—É—Ç –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
            }
        }

        // –ü—Ä–æ—Å—Ç–æ–π —ç—Ñ—Ñ–µ–∫—Ç —Å–∞–ª—é—Ç–∞ (–ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å –∏–ª–∏ –º–æ–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å)
        function createCoinsExplosion() {
            // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
            const winLine = document.querySelector('.win-line');
            winLine.style.display = 'block';
            setTimeout(() => winLine.style.display = 'none', 1000);
        }

        initReels();

    </script>
</body>
</html>
